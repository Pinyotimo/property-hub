{% extends "base.html" %}
{% block title %}Choose Property Image{% endblock %}

{% block content %}
<div class="container py-4">
  <h2>Choose image for: {{ property.title }}</h2>
  <form method="post">
    {% csrf_token %}
    <div class="row">
      {% for img in images %}
        <div class="col-md-3 mb-3">
          <label class="d-block text-center">
            {% with rel_path='property_images/'|add:img %}
            <input type="radio" name="selected_image" value="{{ img }}" {% if property.image and property.image.name|slice:'-999' == rel_path %}checked{% endif %} />
            {% endwith %}
            <div class="card">
              <img src="{{ MEDIA_URL }}property_images/{{ img }}" class="card-img-top img-fluid" alt="{{ img }}">
              <div class="card-body p-2">
                <small class="text-muted">{{ img }}</small>
              </div>
            </div>
          </label>
        </div>
      {% empty %}
        <div class="col-12">
          <p>No images found in <code>media/property_images/</code>.</p>
        </div>
      {% endfor %}
    </div>

    <div class="mt-3">
      <button type="submit" class="btn btn-primary">Set Selected Image</button>
      <a href="{% url 'property_detail' property.pk %}" class="btn btn-secondary">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}
