{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5 p-4 rounded shadow" style="background-color: #f5f7fa;">
  <div class="row g-4">
    <!-- Image Section -->
    <div class="col-md-6">
      {% if property.image %}
        <img src="{{ property.image.url }}" class="img-fluid rounded shadow-sm" alt="Property Image">
      {% else %}
        <img src="{% static 'images/default-property.jpg' %}" class="img-fluid rounded shadow-sm" alt="Default Property">
      {% endif %}
    </div>

    <!-- Details Section -->
    <div class="col-md-6">
      <h2 class="text-primary fw-bold">{{ property.title }}</h2>
      <p class="text-muted">{{ property.description }}</p>

      <ul class="list-unstyled fs-6">
        <li>ğŸ’° <strong>Price:</strong> KES {{ property.price }}</li>
        <li>ğŸ“ <strong>Location:</strong> {{ property.location }}</li>
        <li>ğŸ  <strong>Type:</strong> {{ property.get_property_type_display }}</li>
        <li>ğŸ›ï¸ <strong>Bedrooms:</strong> {{ property.bedrooms }} | ğŸš½ <strong>Bathrooms:</strong> {{ property.bathrooms }}</li>
        <li>ğŸ“ <strong>Size:</strong> {{ property.size }} sq ft</li>
        <li>ğŸ“… <strong>Listed on:</strong> {{ property.listed_date }}</li>
        <li>
          {% if property.status == "available" %}
            âœ… <strong>Status:</strong> <span class="badge bg-success">Available</span>
          {% else %}
            âŒ <strong>Status:</strong> <span class="badge bg-secondary">Unavailable</span>
          {% endif %}
        </li>
      </ul>

      <!-- Amenities -->
      {% if property.amenities %}
        <div class="mt-3">
          <h6 class="fw-semibold">Amenities:</h6>
          <div class="d-flex flex-wrap gap-2">
            {% for amenity in property.amenities.all %}
              <span class="badge bg-light text-dark border">{{ amenity.name }}</span>
            {% endfor %}
          </div>
        </div>
      {% endif %}

      <!-- Action Buttons -->
      {% if request.user.is_authenticated %}
        <div class="mt-4">
          {% if request.user != property.owner %}
            <a href="{% url 'send_message' property.pk %}" class="btn btn-outline-primary btn-sm me-2">Contact Owner</a>
            <a href="{% url 'view_messages' property.pk %}" class="btn btn-info btn-sm">View Messages</a>
          {% endif %}

          {% if request.user == property.owner %}
            <a href="{% url 'property_choose_image' property.pk %}" class="btn btn-secondary btn-sm me-2">Choose Image</a>
            <a href="{% url 'property_update' property.pk %}" class="btn btn-primary btn-sm me-2">Edit</a>
            <a href="{% url 'view_messages' property.pk %}" class="btn btn-info btn-sm">View Messages</a>
          {% endif %}

          {% if request.user == property.owner or request.user.is_superuser or request.user.is_staff %}
            <a href="{% url 'property_delete' property.pk %}" class="btn btn-danger btn-sm mt-2"
               onclick="return confirm('Are you sure you want to delete this property? This action cannot be undone.');">
               Delete
            </a>
          {% endif %}
        </div>
      {% endif %}

      <a href="{% url 'property_list' %}" class="btn btn-outline-secondary mt-4">â† Back to Listings</a>
    </div>
  </div>
</div>
{% endblock %}