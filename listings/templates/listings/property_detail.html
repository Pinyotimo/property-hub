{% extends "base.html" %}
{% load static %}

{% block content %}
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(to right, #fbc2eb, #a6c1ee); /* warm gradient */
  }
  .detail-card {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 16px;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
    padding: 2rem;
  }
  .detail-card h2 {
    font-weight: 700;
    color: #d35400; /* warm orange accent */
  }
  .detail-card p {
    color: #555;
  }
  .badge {
    border-radius: 12px;
    padding: 0.4rem 0.8rem;
  }
  .btn-warm {
    background: linear-gradient(90deg, #ff9966, #ff5e62);
    color: #fff;
    border: none;
    border-radius: 30px;
    padding: 0.5rem 1.2rem;
    font-weight: 600;
    transition: box-shadow 0.3s ease;
  }
  .btn-warm:hover {
    box-shadow: 0 0 12px rgba(255, 94, 98, 0.6);
  }
</style>

<div class="container mt-5">
  <div class="detail-card">
    <div class="row g-4">
      <!-- Image Section -->
      <div class="col-md-6">
        {% if property.image %}
          <img src="{{ property.image.url }}" class="img-fluid rounded shadow-sm" alt="Property Image">
        {% else %}
          <img src="{% static 'images/default-property.jpg' %}" class="img-fluid rounded shadow-sm" alt="Default Property">
        {% endif %}
      </div>

      <!-- Details Section -->
      <div class="col-md-6">
        <h2 class="fw-bold">{{ property.title }}</h2>
        <p>{{ property.description }}</p>

        <ul class="list-unstyled fs-6">
          <li>ğŸ’° <strong>Price:</strong> KES {{ property.price }}</li>
          <li>ğŸ“ <strong>Location:</strong> {{ property.location }}</li>
          <li>ğŸ  <strong>Type:</strong> {{ property.get_property_type_display }}</li>
          <li>ğŸ›ï¸ <strong>Bedrooms:</strong> {{ property.bedrooms }} | ğŸš½ <strong>Bathrooms:</strong> {{ property.bathrooms }}</li>
          <li>ğŸ“ <strong>Size:</strong> {{ property.size }} sq ft</li>
          <li>ğŸ“… <strong>Listed on:</strong> {{ property.listed_date }}</li>
          <li>
            {% if property.status == "available" %}
              âœ… <strong>Status:</strong> <span class="badge bg-success">Available</span>
            {% else %}
              âŒ <strong>Status:</strong> <span class="badge bg-secondary">Unavailable</span>
            {% endif %}
          </li>
        </ul>

        <!-- Amenities -->
        {% if property.amenities %}
          <div class="mt-3">
            <h6 class="fw-semibold">Amenities:</h6>
            <div class="d-flex flex-wrap gap-2">
              {% for amenity in property.amenities.all %}
                <span class="badge bg-light text-dark border">{{ amenity.name }}</span>
              {% endfor %}
            </div>
          </div>
        {% endif %}

        <!-- Action Buttons -->
        {% if request.user.is_authenticated %}
          <div class="mt-4">
            <!-- Show Contact Owner only for buyers -->
            {% if request.user != property.owner and not request.user.is_superuser and not request.user.is_staff %}
              <a href="{% url 'send_message' property.pk %}" class="btn btn-warm btn-sm me-2">Contact Owner</a>
              <a href="{% url 'view_messages' property.pk %}" class="btn btn-info btn-sm">View Messages</a>
            {% endif %}

            <!-- Show Edit/Delete only for owner/admin -->
            {% if request.user == property.owner or request.user.is_superuser or request.user.is_staff %}
              <a href="{% url 'property_update' property.pk %}" class="btn btn-warm btn-sm me-2">Edit</a>
              <a href="{% url 'view_messages' property.pk %}" class="btn btn-success btn-sm">Stk Push</a>
              <a href="{% url 'view_messages' property.pk %}" class="btn btn-info btn-sm">View Messages</a>
              <a href="{% url 'property_delete' property.pk %}" class="btn btn-danger btn-sm mt-2"
                 onclick="return confirm('Are you sure you want to delete this property? This action cannot be undone.');">
                 Delete
              </a>
            {% endif %}
          </div>
        {% endif %}

        <a href="{% url 'property_list' %}" class="btn btn-outline-secondary mt-4">â† Back to Listings</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}